# やる事リスト

※ 自戒: あまり枝葉の設計で肩肘張り過ぎて実装が鈍らないように。まだゴールは果てしなく遠いので、とにかく何かしら書き進める。取っつきやすそうなタスクをここに切り出しつつ。

## 気付いた事（対応が必用な事）

* LightConfig の中の ambientReflectionStrength の Strength ってなんか微妙かも。要再検討
* matrixexam.csv を曲面プロットしてる時、画面左の軸長さスライダーを操作して各軸長めにすると、角度によって面のセルが黒色（#000000）になる。
  光学計算かなんかののバグか？ デフォルトの長さでは起こらないので、変換行列の対角成分を書き換えた事に対して光学計算が対処できていない可能性がありそう。

  * メッシュ、点、線では問題ないので、その事と角度依存な事からすると、明らかに光学周りだ。たぶん。

## メニューの実装を進める

* 済: 軸反転とか対数軸とかのオプション。これは ScaleConfig を書き換える。ScaleSpaceConfig みたいなんが新規で要る？
  -> データ変換を後で入れ込むなら、それを踏まえた config 管轄を作った方がいいかも。対数プロットもまあデータ変換の一種っちゃあ一種っぽいので。

     -> 軸反転は違うのでは？
        -> 確かに軸反転はどっちかというと描画側の事情。しかし対数軸との親戚な概念の気もする。概念境界意外とややこしいな。

     * 恐らく目盛り設定の管轄でもないからなあ軸反転は。まさに空間設定だ。
       -> いや普通に目盛り管轄じゃないの？ 目盛り管轄に対数プロットと軸反転あってもなんら変じゃない気がするが。

       * 確かに。データ変換という目線で見ると目盛りじゃないが、目盛りという目線で見ると目盛りだ。データ変換を別枠にするならまあアリか。

         * そもそもデータ変換しても目盛りは変わらないが、対数軸は目盛りが変わるし、質的に対数軸は普通のデータ変換より上位層での存在でしょ。
           まず対数軸の目盛りが振られた空間（またはリアルスケール空間）というものがあって、そこにデータ変換したデータをプロットする。
           なので、データ変化の config 管轄に対数軸を入れ込む事にこだわる妥当性はよく考えたらそんなになさそう。

           で、空間設定っていう config をわざわざ作るくらいなら、
           AxisScaleConfig 内に isLogScaleEnabled と isReversed とかがあればそれで十分で、直感的にもわかりやすい気がする。
           だってそもそも普通に言葉として「log scale / 対数目盛り」ってみんな言ってんだし。

           -> たぶん空間設定っていう概念は、軸反転と対数軸を一緒にペアにして考えた結果として浮かぶイメージだと思う。
              対数軸が scale config でいいなら、残りは軸反転が scale config に居ていいか？ って話になる。

              -> まあ log scale が許されるなら軸反転が許されない気はないと思う。軸反転の方が対数軸よりもっと低抽象度な空間変換なので。

                 で、GUI で「空間」タブができる感じかな。オプションのみにしてもいいけど、目盛り設定にもシンクロページがあってもいい。必須じゃないので後でいいけど。

  * 上記の結果からして AxisScaleConfig に入れ込むとして、実装はどうする？
    -> Renderer 内の rotationMatrix の右に、単位行列の各成分の符号反転させたやつをかければいい。たぶんそれが一番シンプル
       * 各成分の絶対値を変える事で、軸長の変化も一緒に実装できる。やっとグラフ左のバーの操作に対応できるか。

         * 上記がよさそう。とりあえずこの方向性で実装を進める。

* 済: 画面再度の次元長スライダー

* 等高線オプション。これは現状とりあえず 5.x のコードからそのまま移植でいい。あれ掃除するのはたぶん大変で、コーナーケースがたくさんあるから用意周到にやらなきゃだし。現状ちゃんと動いてるし、閉じてる処理だから中をいじる機会もほぼ無いし、なのでとりあえずそのままで。中をいじる機会がある時にまた検討する。

## API系の5.x互換レベル到達を急ぐ

* GUI含む全機能の完成にはまだ距離があるが、APIだけでも5.x互換なレベルにもっていけたら、とりあえずグラフ描画ライブラリとしての用途はカバーできる。そっち方面の展開は正式リリース前でも進められる。ので効果としてでかい。優先的に急いで推進すべき。
* 描画エンジンの文字列書くAPI。エンジンを組み込みに使ってるユーザー層が（少ないが）存在はしているので、とりあえず描画エンジンAPIだけでもオープンソースで全用途カバーしたい。そしたら簡易3D描画ウィンドウとしてはとりあえず使えるようになる。

## 描画関連を最低限実用できるあたりまで充実させる

* アニメーションとかだと系列数が膨大になるので、凡例としてどういう形が適切か？ を考える。少なくともそれを考慮すると、凡例は「大系列ごと」か「小系列ごと」かのモード切り替えが必要になりそう。
* 上記に付随して、場合によっては系列の階層を増やす必要があるかも。DataSeriesGroup はファイル1個や z(x,y,t) 数式1個に対応するので(contains multiple DataSeries)、それをさらに包む構造が… しかし名前がややこしいなそれたぶん。

## 数式関連を最低限実用できるあたりまで充実させる

* 済（実装も）: 「x(t),y(t),z(t)」形式の実装について考える。変数 t をアニメーションモードとどう整合させるべきか。もしくは t を避けて s や i にするか。-> i は将来的に複素サポートした時にややこしいので n か。-> いやしかしここでの t は整数じゃなく実数でしょ。i や n はまずい。線素の累積だし普通に s でいいんじゃないの。どうせこんなんプロットすんの理工系の人だし線積分やってるでしょ。伝わるって。むしろ t よりも。t は微分方程式くさいし s の方がむしろベストな気もするし。 -> いや線素の累積値ちゃうで。線の周辺なぞる長さのディメンションには対応してないやろ。依存してるだけや。まさに動きにおける t 的な量や。属するディメンションが全然ちゃう。 -> ああ確かに、どうすっかな -> アニメーションのTRACEモードは座標点 i を t = i * Δt where Δt = timeRange/N と見なしてアニメーションするモードやし、プロット画面で「アニメーション」を選んだらアニメーション画面をTRACEモードで開いてΔtの値を通知セットすれば何も問題なにのでは？ どこも概念的な不整合はない。TRACEモードの想定概念そのもの。 -> 確かに。じゃあ問題は z(x,y,t) の方か。-> z(x,y,t) も「系列を時系列と見なしてプロット」の想定概念そのもので、Δtを適切に通知転送すれば何も問題がない。-> 要は両者でアニメーションモードが違うというだけで、同時に両立はしないけども、アニメーションモードと概念矛盾はしない。z(x,y,t) と x(t),t(t),z(t) を同時に同じ t でアニメーションさせられないというだけ。それはちょうど、異なるアニメーションモードを想定したデータファイルを、同時にアニメーションさせられないのと同じ原因で、数式自体の問題ではない。アニメーションモード側でそういう仕組み（複数モードのシンクロナイザみたいなもん）を作るかどうかの問題。 -> 確かに。じゃあここではとりあえず安心して Ver.5.6 と同等の処理をするツールをそのまま組み込みで実装すればいいだけか。あとの改善や割り切りはアニメーションツール実装時の管轄で、今ここの実装の段階で悩む必用はない。素直に Ver.5.6 の正常進化形でやればいい。安心納得。
* 同様に「z(x,y,t)」についても考える必要がある。上記と同時に考えるべき。-> 考察は着地した（上記参照）。素直に複数系列のメッシュを生成すればいい。-> 凡例がどえらい事にならん？ -> ああ… なんか特例が要るかな。 -> いや、凡例はファイルごとに付くし、ファイルは複数系列を含み得るので、大系列ごとに付けられるようにすればいい。そういう仕様にすれば、z(x,y,t) は t ごとに異なる系列を含む大系列が1つなので、凡例はすっきり書ける。凡例のオプションで「大系列ごと」か「小系列ごと」を選べるようにすればいい。 -> つまりこれも凡例の実装側で悩む管轄の話で、この数式ツール実装の時点で悩む必要はない。
* 数式は設定ファイルで保存できてもいい。ファイルパスとは違って外部に依存せずソフト内で閉じてる情報だし、特定の数式を色んなファイルに重ねて表示したいような解析シーンはよくあるし。将来的に。

## ちょっと思いつき系

* Vnano.jar、内蔵の数式プロット機能（外部スクリプトではない）に使ってるからもうエンジン自体も RinearnGraph3D.jar 内に入れ込んでしまった方がいいのでは？
  アプリ内に RinearnGraph3D.jar を組み込んで使う用途で、一発でいけるようになる。現状だと lib/app-dependency から Vnano.jar も引っ張ってこないといけない。
  で、RinearnGraph3D.jar を組み込む用途だと、数式も描ければ描きたいだろうし、 Vnano.jar も大抵は居るでしょ。

  * 確かに。標準プラグインはどうすべき？
    -> 同じ理由で Math 系は RinearnGraph3D.jar 内に入れといてもいいかな。
       ぜんぶ使える必用はないけれど。追加で使いたいやつは自力で追加してもらえばいい。標準でよく使う数式プラグインくらいは入れといた方がいいかも。

    * VnanoConfiguration とかで設定できてもいい。GUIだと「Vnanoスクリプトエンジン設定」か。独自実装プラグインやライブラリはそっちで指定し、SET を押すと確認メッセージ出したうえで lib/VnanoLibraryList.txt とかを書き換える。
      無ければその時に「フォルダや設定ファイルが指定位置にありません」って出す。アプリ実装する人はそこで気付けるしそれでいいかと。

* EnvironmentConfiguration, SystemConfiguration とかに変えるべき？ というか命名時も絶対思い浮かんだはずだけど、なんで採用しなかった？
  綴りが長て読み書きコスト高く、非直感的で抽象的な命名で、さらにメッセージの言語ロケールの取得とかで頻繁に参照する。もうちょいなんとかすべきかも。

  -> いやでも走りながら考えてきたらやっぱUIでは「環境設定」即ち「Environment Settings」が良い気がしてきたし、
     それだとコンテナが EnvironmentConfiguration になるのは妥当な気がする。
     UIでメニューに「環境設定」と「システム設定」がある時、どっちが分かりやすいか？って話。日本語/英語とか切り替えるのに。前者では。

### 長い脳内議論はこっちで


